
# --- Calculate EMAs ---
df['EMA_9'] = df['Close'].ewm(span=9, adjust=False).mean()
df['EMA_15'] = df['Close'].ewm(span=15, adjust=False).mean()

# --- Identify Crossovers ---
df['Buy_Signal'] = (df['EMA_9'] > df['EMA_15']) & (df['EMA_9'].shift(1) <= df['EMA_15'].shift(1))
df['Sell_Signal'] = (df['EMA_9'] < df['EMA_15']) & (df['EMA_9'].shift(1) >= df['EMA_15'].shift(1))

# --- Assign Actions ---
df['Action'] = np.select([df['Buy_Signal'], df['Sell_Signal']], ['buy', 'sell'], default=None)
